# NAVER Blog - XSS

## 2020-02-05

### 카테고리 공략 시도
블로그를 보면 대부분 카테고리가 화면에 노출된다. 그래서 카테고리에 HTML 태그를 삽입할 수 있을지 확인해보기로 했다.

![](2020-02-05&#32;16-52-05.png)

카테고리명에는 `<>`를 비롯한 특수문자를 입력할 수 없었다. 그래서 요청을 보낼 때 파라미터 조작을 시도했다.

카테고리명에 입력한 내용은 `updatedCategoryListStruct` 파라미터 값에서 확인할 수 있었는데, 값이 두 번 URL 인코딩 되어 있었다. 평문으로 디코딩 해보니 JSON 형식의 카테고리에 대한 내용인 것을 알 수 있었다. 원래 입력했던 카테고리명을 간단한 XSS 페이로드로 바꾸고 다시 인코딩하여 요청을 보냈다.

![](2020-02-05&#32;17-25-51.png)

하지만 `<>`가 필터링되어 태그가 삽입되지 않았다.

### 안부게시판 공략 시도
안부게시판에 게시글로 XSS 페이로드를 등록했을 때 입력한 값이 그대로 적용되어서 필터링을 확인하기 위해 소스 코드를 확인해봤다.

![](2020-02-05&#32;20-34-47.png)

특수문자가 HTML 엔티티로 치환되는 것을 볼 수 있다. 값이 전달되는 것을 확인하기 위해 프록시로 잡아 봤다.

```http
content=%253Cscript%253Ealert(1)%253B%253C%252Fscript%253E
```
먼저 입력한 값을 체크하기 위해 위와 같이 두 번 URL 인코딩 되어 전달된다.

```http
contents=%26lt%3Bscript%26gt%3Balert%281%29%3B%26lt%3B%2Fscript%26gt%3B
```
그 다음에 전달 받은 값을 HTML 엔티티로 치환하여 글로 등록하게 된다. 이 부분에 페이로드를 직접 입력하면 어떻게 적용될지 궁금했다.

![](2020-02-05&#32;21-23-08.png)

위에서와 같이 치환되어 등록되었는데 이번에는 주석이 추가된 것을 확인할 수 있었다. 태그를 삽입할 수 없도록 별도의 필터링이 적용된 것으로 보인다. 혹시 다른 태그는 삽입할 수 있는지 몇 가지 시도해봤는데, 사진 올리기가 가능해서 그런지 `<img>` 태그는 삽입이 가능했다.

![](2020-02-05&#32;21-53-02.png)

그래서 속성값에 `alert` 함수를 넣어봤지만 이번에는 속성이 필터링 되었다. 아마 전반적인 XSS 필터링이 되어 있기 때문에 취약점을 찾기 쉽지 않을 것으로 생각된다.